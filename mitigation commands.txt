mitigation

(Admin)

cd "M:\CCNS project work\project\iot-botnet-simulation"

# 1) ensure captures folder exists and show its full path
if (-Not (Test-Path .\captures)) { New-Item -ItemType Directory -Path .\captures | Out-Null }
Write-Host "CAPTURES:" (Resolve-Path .\captures)

# 2) list running containers (names, image, status)
docker ps --format "table {{.Names}}\t{{.Image}}\t{{.Status}}"

# 3) list docker networks (to find the project's network name)
docker network ls --format "table {{.Name}}\t{{.Driver}}"

(MQTT tab)

cd "M:\CCNS project work\project\iot-botnet-simulation"

# Try to tail the Mosquitto "not authorised" file; if that fails, stream container logs
docker-compose exec mosquitto sh -lc 'test -f /mosquitto/log/mosquitto_not_authorised.log && tail -n 100 -F /mosquitto/log/mosquitto_not_authorised.log'
if ($LASTEXITCODE -ne 0) {
  docker logs -f mosquitto --tail 200
}
 
 (C2 logs tab)

cd "M:\CCNS project work\project\iot-botnet-simulation"
docker logs -f <C2_NAME> --tail 200

(victim logs)

cd "M:\CCNS project work\project\iot-botnet-simulation"
docker logs -f <VICTIM_NAME> --tail 200


(capture tab) 

cd "M:\CCNS project work\project\iot-botnet-simulation"
$capPath = (Resolve-Path .\captures).Path

# Share network namespace with the mosquitto container
docker run --rm --network container:mosquitto -v "${capPath}:/captures" --name netdump nicolaka/netshoot `
  tcpdump -i any -s 0 -w /captures/mosq_all.pcap tcp port 1883

 (post filter)

cd "M:\CCNS project work\project\iot-botnet-simulation\captures"
$capPath = (Resolve-Path .).Path

docker run --rm -v "${capPath}:/captures" debian:bookworm-slim bash -lc '
  set -e
  apt-get update >/dev/null
  DEBIAN_FRONTEND=noninteractive apt-get install -y tshark >/dev/null
  # Find TCP stream IDs where CONNACK is "accepted" in v5 (reason_code==0) or v3.1.1 (return_code==0)
  tshark -r /captures/mosq_all.pcap \
    -Y "mqtt.msgtype == 2 && (mqtt.reason_code == 0 || mqtt.connack.return_code == 0)" \
    -T fields -e tcp.stream \
  | sort -u > /captures/good_streams.txt
'
# show the resulting stream IDs
Get-Content .\good_streams.txt

Capture tab â€” rerun capture (single step)

cd "M:\CCNS project work\project\iot-botnet-simulation"
$capPath = (Resolve-Path .\captures).Path

# Share network namespace with the mosquitto container
docker run --rm --network container:mosquitto -v "${capPath}:/captures" --name netdump nicolaka/netshoot `
  tcpdump -i any -s 0 -w /captures/mosq_all.pcap tcp port 1883
