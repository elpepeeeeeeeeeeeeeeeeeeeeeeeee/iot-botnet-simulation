Set-Location "M:\CCNS project work\project\iot-botnet-simulation"
$pcap = Get-Item ".\victim_capture_20251018_014630.pcap"

# 1) Total packets (quick)
& "C:\Program Files\Wireshark\tshark.exe" -r $pcap.FullName -q -z io,stat,0

# 2) Count HTTP GETs
& "C:\Program Files\Wireshark\tshark.exe" -r $pcap.FullName -Y 'http.request.method == "GET"' -T fields -e frame.number |
  Measure-Object -Line

# 3) Create a GET-only pcap (for offline analysis or sharing)
& "C:\Program Files\Wireshark\tshark.exe" -r $pcap.FullName -Y 'http.request.method == "GET"' -w ".\victim_gets.pcap"
